{"version":3,"sources":["../src/renderer.js"],"names":["_","$","kbn","moment","DataTable","DatatableRenderer","panel","table","isUtc","sanitize","formatters","colorState","value","style","thresholds","i","length","colors","first","v","column","undefined","isArray","join","link","url","text","replace","escape","defaultCellFormatter","type","date","utc","format","dateFormat","valueFormatter","valueFormats","unit","isString","colorMode","getColorForValue","decimals","colIndex","columns","styles","regex","stringToJsRegex","pattern","match","createColumnFormatter","rowData","formattedRowData","y","row","rows","cellData","formatColumnValue","hidden","push","rowNumbersEnabled","unshift","columnNumber","colStyle","items","split","bgColor","bgColorIndex","color","colorIndex","isNaN","parseFloat","getStyleForColumn","cell","rowcolumn","getColorIndexForValue","columnName","columnAlias","columnAliases","name","alias","columnWidth","columnWidthHints","width","tableHolderId","id","fn","dataTable","isDataTable","aDT","destroy","empty","err","console","log","message","emptyData","customColumns","srcColumns","columnDefs","_this","rowNumberOffset","title","getColumnAlias","columnWidthHint","getColumnWidthHint","columnClassName","className","td","col","css","fontSize","actualColumn","rowColor","rowColorIndex","rowColorData","getCellColors","parentNode","children","aChild","colorData","should_destroy","destroyedDT","formattedData","generateFormattedData","panelHeight","orderSetting","map","columnSortingRules","sort","findIndex","tableOptions","searching","searchEnabled","info","infoEnabled","lengthChange","lengthChangeEnabled","scrollCollapse","scrollX","stateSave","mark","dom","buttons","select","data","order","scroll","paging","scrollY","pagingType","datatablePagingType","$datatable","newDT","visible","compactRowsEnabled","addClass","stripedRowsEnabled","hoverEnabled","orderColumnEnabled","showCellBorders","showRowBorders","rowsPerPage","page","len","draw","on","search","nodes","each","innerHTML","new_row"],"mappings":"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","file":"renderer.js","sourcesContent":["import _ from 'lodash';\nimport $ from 'jquery';\nimport kbn from 'app/core/utils/kbn';\nimport moment from 'moment';\nimport DataTable from './libs/datatables.net/js/jquery.dataTables.min.js';\n\nexport class DatatableRenderer {\n  constructor(panel, table, isUtc, sanitize) {\n    this.formatters = [];\n    this.colorState = {};\n    this.panel = panel;\n    this.table = table;\n    this.isUtc = isUtc;\n    this.sanitize = sanitize;\n  }\n\n  /**\n   * Given a value, return the color corresponding to the threshold set\n   * @param  {[Float]} value [Value to be evaluated]\n   * @param  {[Array]} style [Settings containing colors and thresholds]\n   * @return {[String]}       [color]\n   */\n  getColorForValue(value, style) {\n    if (!style.thresholds) {\n      return null;\n    }\n    for (var i = style.thresholds.length; i > 0; i--) {\n      if (value >= style.thresholds[i - 1]) {\n        return style.colors[i];\n      }\n    }\n    return _.first(style.colors);\n  }\n\n  // to determine the overall row color, the index of the threshold is needed\n  getColorIndexForValue(value, style) {\n    if (!style.thresholds) {\n      return null;\n    }\n    for (var i = style.thresholds.length; i > 0; i--) {\n      if (value >= style.thresholds[i - 1]) {\n        return i;\n      }\n    }\n    return 0;\n  }\n\n  /**\n   * [defaultCellFormatter description]\n   * @param  {[type]} v     [description]\n   * @param  {[type]} style [description]\n   * @return {[type]}       [description]\n   */\n  defaultCellFormatter(v, style, column) {\n    if (v === null || v === void 0 || v === undefined || column === null) {\n      return '';\n    }\n    if (_.isArray(v)) {\n      v = v.join(', ');\n    }\n    if (style && style.sanitize) {\n      return this.sanitize(v);\n    }\n    else if (style && style.link && style.url && column.text === style.column) {\n      return '<a href=\"' + style.url.replace('{}', v) + '\" target=\"_blank\">' + v + '</a>';\n    }\n    else if (style && style.link) {\n      return '<a href=\"' + v + '\" target=\"_blank\">' + v + '</a>';\n    }\n    else {\n      return _.escape(v);\n    }\n  }\n\n  /**\n   * [createColumnFormatter description]\n   * @param  {[type]} style  [description]\n   * @param  {[type]} column [description]\n   * @return {[type]}        [description]\n   */\n  createColumnFormatter(style, column) {\n    if (!style) {\n      return this.defaultCellFormatter;\n    }\n    if (style.type === 'hidden') {\n      return v => {\n        return undefined;\n      };\n    }\n    if (style.type === 'date') {\n      return v => {\n        if (v === undefined || v === null) {\n          return '-';\n        }\n        if (_.isArray(v)) {\n          v = v[0];\n        }\n        var date = moment(v);\n        if (this.isUtc) {\n          date = date.utc();\n        }\n        return date.format(style.dateFormat);\n      };\n    }\n    if (style.type === 'number') {\n      let valueFormatter = kbn.valueFormats[column.unit || style.unit];\n      return v => {\n        if (v === null || v === void 0) {\n          return '-';\n        }\n        if (_.isString(v)) {\n          return this.defaultCellFormatter(v, style, column);\n        }\n        if (style.colorMode) {\n          this.colorState[style.colorMode] = this.getColorForValue(v, style);\n        }\n        return valueFormatter(v, style.decimals, null);\n      };\n    }\n    return (value) => {\n      return this.defaultCellFormatter(value, style, column);\n    };\n  }\n\n  /**\n   * [formatColumnValue description]\n   * @param  {[type]} colIndex [description]\n   * @param  {[type]} value    [description]\n   * @return {[type]}          [description]\n   */\n  formatColumnValue(colIndex, value) {\n    if (this.formatters[colIndex]) {\n      return this.formatters[colIndex](value);\n    }\n    var columns = this.panel.columns.length ? this.panel.columns : this.table.columns;\n\n    for (let i = 0; i < this.panel.styles.length; i++) {\n      let style = this.panel.styles[i];\n      let column = columns[colIndex];\n      var regex = kbn.stringToJsRegex(style.pattern);\n      if (column.text.match(regex)) {\n        this.formatters[colIndex] = this.createColumnFormatter(style, column);\n        return this.formatters[colIndex](value);\n      }\n    }\n\n    this.formatters[colIndex] = this.defaultCellFormatter;\n    return this.formatters[colIndex](value);\n  }\n\n  /**\n   * [generateFormattedData description]\n   * @param  {[type]} rowData [description]\n   * @return {[type]}         [description]\n   */\n  generateFormattedData(rowData) {\n    let formattedRowData = [];\n    var columns = this.panel.columns.length ? this.panel.columns : this.table.columns;\n    for (var y = 0; y < rowData.length; y++) {\n      let row = this.table.rows[y];\n      let cellData = [];\n      //cellData.push('');\n      for (var i = 0; i < columns.length; i++) {\n        let value = this.formatColumnValue(i, row[i]);\n        if (value === undefined) {\n          columns[i].hidden = true;\n        }\n        cellData.push(this.formatColumnValue(i, row[i]));\n      }\n      if (this.panel.rowNumbersEnabled) {\n        cellData.unshift('rowCounter');\n      }\n      formattedRowData.push(cellData);\n    }\n    return formattedRowData;\n  }\n\n  getStyleForColumn(columnNumber) {\n    let colStyle = null;\n    var columns = this.panel.columns.length ? this.panel.columns : this.table.columns;\n    for (let i = 0; i < this.panel.styles.length; i++) {\n      let style = this.panel.styles[i];\n      let column = columns[columnNumber];\n      if (column === undefined) break;\n      var regex = kbn.stringToJsRegex(style.pattern);\n      if (column.text.match(regex)) {\n        colStyle = style;\n        break;\n      }\n    }\n    return colStyle;\n  }\n\n  getCellColors(colorState, columnNumber, cellData) {\n    var items = cellData.split(/(\\s+)/);\n    // only color cell if the content is a number?\n    var bgColor = null;\n    var bgColorIndex = null;\n    var color = null;\n    var colorIndex = null;\n    let colStyle = null;\n    let value = null;\n    // check if the content has a numeric value after the split\n    if (!isNaN(items[0])) {\n      // run value through threshold function\n      value = parseFloat(items[0].replace(\",\", \".\"));\n      colStyle = this.getStyleForColumn(columnNumber);\n    }\n    if (colStyle !== null) {\n      // check color for either cell or row\n      if ((colorState.cell) || (colorState.row) || (colorState.rowcolumn)){\n        // bgColor = _this.colorState.cell;\n        bgColor = this.getColorForValue(value, colStyle);\n        bgColorIndex = this.getColorIndexForValue(value, colStyle);\n        color = 'white';\n      }\n      // just the value color is set\n      if (colorState.value) {\n        //color = _this.colorState.value;\n        color = this.getColorForValue(value, colStyle);\n        colorIndex = this.getColorIndexForValue(value, colStyle);\n      }\n    }\n    return {\n      bgColor: bgColor,\n      bgColorIndex: bgColorIndex,\n      color: color,\n      colorIndex: colorIndex\n    };\n  }\n\n  getColumnAlias(columnName) {\n    // default to the columnName\n    var columnAlias = columnName;\n    if (this.panel.columnAliases !== undefined) {\n      for (let i = 0; i < this.panel.columnAliases.length; i++) {\n        if (this.panel.columnAliases[i].name === columnName) {\n          columnAlias = this.panel.columnAliases[i].alias;\n          break;\n        }\n      }\n    }\n    return columnAlias;\n  }\n\n  getColumnWidthHint(columnName) {\n    // default to the columnName\n    var columnWidth = '';\n    if (this.panel.columnWidthHints !== undefined) {\n      for (let i = 0; i < this.panel.columnWidthHints.length; i++) {\n        if (this.panel.columnWidthHints[i].name === columnName) {\n          columnWidth = this.panel.columnWidthHints[i].width;\n          break;\n        }\n      }\n    }\n    return columnWidth;\n  }\n\n  /**\n   * Construct table using Datatables.net API\n   *  multiple types supported\n   * timeseries_to_rows (column 0 = timestamp)\n   * timeseries_to_columns\n   * timeseries_aggregations - column 0 is the metric name (series name, not a timestamp)\n   * annotations - specific headers for this\n   * table\n   * json (raw)\n   * columns[x].type === \"date\" then set columndefs to parse the date, otherwise leave it as default\n   * convert table.columns[N].text to columns formatted to datatables.net format\n   * @return {[Boolean]} True if loaded without errors\n   */\n  render() {\n    const tableHolderId = '#datatable-panel-table-' + this.panel.id;\n    try {\n      if ($.fn.dataTable.isDataTable(tableHolderId)) {\n        var aDT = $(tableHolderId).DataTable();\n        aDT.destroy();\n        $(tableHolderId).empty();\n      }\n    }\n    catch(err) {\n      console.log(\"Exception: \" + err.message);\n    }\n\n    if (this.panel.emptyData) {\n      return;\n    }\n    var customColumns = !!this.panel.columns.length,\n        srcColumns = customColumns ? this.panel.columns : this.table.columns,\n        columns = [],\n        columnDefs = [],\n        _this = this,\n        rowNumberOffset = 0;\n    \n    if (this.panel.rowNumbersEnabled) {\n      rowNumberOffset = 1;\n      columns.push({\n        title: '',\n        type: 'number'\n      });\n      columnDefs.push(\n        {\n            \"searchable\": false,\n            \"orderable\": false,\n            \"targets\": 0,\n            \"width\": \"1%\",\n        });\n    }\n    for (let i = 0; i < srcColumns.length; i++) {\n      var columnAlias = this.getColumnAlias(srcColumns[i].text);\n      var columnWidthHint = this.getColumnWidthHint(srcColumns[i].text);\n      var columnClassName = 'dt-left';\n      if (srcColumns[i].type == 'number'){\n        columnClassName = 'dt-right'; // any reason not to align numbers right?\n      }\n      // NOTE: the width below is a \"hint\" and will be overridden as needed, this lets most tables show timestamps\n      // with full width\n      /* jshint loopfunc: true */\n      columns.push({\n        title: columnAlias,\n        //type: srcColumns[i].type, /* fix sorting of numbers by simply disable datatables column type and fall back to default... might break date sorting... */\n        width: columnWidthHint,\n        className: columnClassName,\n      });\n        columnDefs.push(\n          {\n            \"targets\": i + rowNumberOffset,\n            \"createdCell\": function (td, cellData, rowData, row, col) {\n              // hidden columns have null data\n              if (cellData === null) return;\n              // set the fontsize for the cell\n              $(td).css('font-size', _this.panel.fontSize);\n              // undefined types should have numerical data, any others are already formatted\n              let actualColumn = col;\n              if (_this.panel.rowNumbersEnabled) {\n                actualColumn -= 1;\n              }\n              if (srcColumns[actualColumn].type !== undefined) return;\n              // for coloring rows, get the \"worst\" threshold\n              var rowColor = null;\n              var color = null;\n              var rowColorIndex = null;\n              var rowColorData = null;\n              if (_this.colorState.row) {\n                // run all of the rowData through threshold check, get the \"highest\" index\n                // and use that for the entire row\n                if (rowData === null) return;\n                rowColorIndex = -1;\n                rowColorData = null;\n                rowColor = _this.colorState.row;\n                // this should be configurable...\n                color = 'white';\n                for (let columnNumber = 0; columnNumber < srcColumns.length; columnNumber++) {\n                  // only columns of type undefined are checked\n                  if (srcColumns[columnNumber].type === undefined) {\n                    rowColorData = _this.getCellColors(_this.colorState, columnNumber, rowData[columnNumber + rowNumberOffset]);\n                    if (rowColorData.bgColorIndex !== null) {\n                      if (rowColorData.bgColorIndex > rowColorIndex) {\n                        rowColorIndex = rowColorData.bgColorIndex;\n                        rowColor = rowColorData.bgColor;\n                      }\n                    }\n                  }\n                }\n                // style the entire row (the parent of the td is the tr)\n                // this will color the rowNumber and Timestamp also\n                $(td.parentNode).children().css('color', color);\n                $(td.parentNode).children().css('background-color', rowColor);\n              }\n\n              if (_this.colorState.rowcolumn) {\n                // run all of the rowData through threshold check, get the \"highest\" index\n                // and use that for the entire row\n                if (rowData === null) return;\n                rowColorIndex = -1;\n                rowColorData = null;\n                rowColor = _this.colorState.rowcolumn;\n                // this should be configurable...\n                color = 'white';\n                for (let columnNumber = 0; columnNumber < srcColumns.length; columnNumber++) {\n                  // only columns of type undefined are checked\n                  if (srcColumns[columnNumber].type === undefined) {\n                    rowColorData = _this.getCellColors(_this.colorState, columnNumber, rowData[columnNumber + rowNumberOffset]);\n                    if (rowColorData.bgColorIndex !== null) {\n                      if (rowColorData.bgColorIndex > rowColorIndex) {\n                        rowColorIndex = rowColorData.bgColorIndex;\n                        rowColor = rowColorData.bgColor;\n                      }\n                    }\n                  }\n                }\n                // style the rowNumber and Timestamp column\n                // the cell colors will be determined in the next phase\n                if (srcColumns[0].type !== undefined) {\n                  var children = $(td.parentNode).children();\n                  var aChild = children[0];\n                  $(aChild).css('color', color);\n                  $(aChild).css('background-color', rowColor);\n                  // the 0 column contains the row number, if they are enabled\n                  // then the above just filled in the color for the row number,\n                  // now take care of the timestamp\n                  if (_this.panel.rowNumbersEnabled) {\n                    aChild = children[1];\n                    $(aChild).css('color', color);\n                    $(aChild).css('background-color', rowColor);\n                  }\n                }\n              }\n\n              // Process cell coloring\n              // Two scenarios:\n              //    1) Cell coloring is enabled, the above row color is skipped\n              //    2) RowColumn is enabled, the above row color is process, but we also\n              //    set the cell colors individually\n              var colorData = _this.getCellColors(_this.colorState, actualColumn, cellData);\n              if ((_this.colorState.cell) || (_this.colorState.rowcolumn)){\n                if (colorData.color !== undefined) {\n                  $(td).css('color', colorData.color);\n                }\n                if (colorData.bgColor !== undefined) {\n                  $(td).css('background-color', colorData.bgColor);\n                }\n              } else if (_this.colorState.value) {\n                if (colorData.color !== undefined) {\n                  $(td).css('color', colorData.color);\n                }\n              }\n            }\n          }\n        );\n    }\n\n    try {\n      var should_destroy = false;\n      if ( $.fn.dataTable.isDataTable( '#datatable-panel-table-' + this.panel.id )) {\n        should_destroy = true;\n      }\n      if (should_destroy) {\n        var destroyedDT = $('#datatable-panel-table-' + this.panel.id).DataTable();\n        destroyedDT.destroy();\n        $('#datatable-panel-table-' + this.panel.id).empty();\n      }\n    }\n    catch(err) {\n      console.log(\"Exception: \" + err.message);\n    }\n    // sanity check\n    // annotations come back as 4 items in an array per row. If the first row content is undefined, then modify to empty\n    // since datatables.net throws errors\n    if (this.table.rows[0].length === 4) {\n      if (this.table.rows[0][0] === undefined) {\n        // detected empty annotations\n        this.table.rows = [];\n      }\n    }\n    // pass the formatted rows into the datatable\n    var formattedData = this.generateFormattedData(this.table.rows);\n\n    if (this.panel.rowNumbersEnabled) {\n      // shift the data to the right\n    }\n    var panelHeight = this.panel.panelHeight;\n    let orderSetting = _.map(this.panel.columnSortingRules, ({name, sort})=> [_.findIndex(srcColumns, {text:name}), sort]);\n    //if (this.panel.rowNumbersEnabled) {\n    //  // when row numbers are enabled, show them ascending\n    //  orderSetting = [[0, 'asc']];\n    //}\n\n    var tableOptions = {\n      \"lengthMenu\": [ [5, 10, 25, 50, 75, 100, -1], [5, 10, 25, 50, 75, 100, \"All\"] ],\n      searching: this.panel.searchEnabled,\n      info: this.panel.infoEnabled,\n      lengthChange: this.panel.lengthChangeEnabled,\n      scrollCollapse: false,\n      scrollX: true,\n      stateSave: true,\n      mark: true,\n      dom: 'Bfrtip',\n      buttons: [\n        'copy', 'excel', 'csv', 'pdf', 'print'\n      ],\n      select: {\n        style: 'os'\n      },\n      data: formattedData,\n      columns: columns,\n      columnDefs: columnDefs,\n      \"search\": {\n        \"regex\": true\n      },\n      order: orderSetting\n    };\n    if (this.panel.scroll) {\n      tableOptions.paging = false;\n      tableOptions.scrollY = panelHeight;\n    } else {\n      tableOptions.paging = true;\n      tableOptions.pagingType = this.panel.datatablePagingType;\n    }\n    var $datatable = $(tableHolderId);\n    var newDT = $datatable.DataTable(tableOptions);\n\n    // hide columns that are marked hidden\n    for (let i = 0; i < srcColumns.length; i++) {\n      if (srcColumns[i].hidden) {\n        newDT.column( i + rowNumberOffset ).visible( false );\n      }\n    }\n\n    // enable compact mode\n    if (this.panel.compactRowsEnabled) {\n      $datatable.addClass( 'compact' );\n    }\n    // enable striped mode\n    if (this.panel.stripedRowsEnabled) {\n      $datatable.addClass( 'stripe' );\n    }\n    if (this.panel.hoverEnabled) {\n      $datatable.addClass( 'hover' );\n    }\n    if (this.panel.orderColumnEnabled) {\n      $datatable.addClass( 'order-column' );\n    }\n    // these two are mutually exclusive\n    if (this.panel.showCellBorders) {\n      $datatable.addClass( 'cell-border' );\n    } else {\n      if (this.panel.showRowBorders) {\n        $datatable.addClass( 'row-border' );\n      }\n    }\n    if (!this.panel.scroll) {\n      // set the page size\n      if (this.panel.rowsPerPage !== null) {\n        newDT.page.len( this.panel.rowsPerPage ).draw();\n      }\n    }\n    // function to display row numbers\n    if (this.panel.rowNumbersEnabled) {\n      newDT.on( 'order.dt search.dt', function () {\n        newDT.column(0, {search:'applied', order:'applied'}).nodes().each( function (cell, i) {\n            cell.innerHTML = i+1;\n        } );\n      } ).draw();\n    }\n  }\n\n  render_values() {\n      let rows = [];\n      var columns = this.panel.columns.length ? this.panel.columns : this.table.columns;\n\n      for (var y = 0; y < this.table.rows.length; y++) {\n        let row = this.table.rows[y];\n        let new_row = [];\n        for (var i = 0; i < columns.length; i++) {\n          new_row.push(this.formatColumnValue(i, row[i]));\n        }\n        rows.push(new_row);\n      }\n      return {\n          columns: columns,\n          rows: rows,\n      };\n  }\n}\n"]}